tgmcevaluation <- read.csv("/Watson/tgmcevaluation.csv", header=F)

#Column 1 in tgmc evaluation is ids.  column 2 is question number
#the regression equation thinks x2 column is the 3rd column in teh tgmc.  Thus kill one column in tgmc
rm(x)
x<-tgmcevaluation[,2:320]
str(x)
rm(y)

#submission 1-4 algorithm
y = 1/(1 + exp(-(-2.0176*x[2] + 0.0781*x[3] + 0.1635*x[6] + -0.4644*x[7] + 0.3027*x[8] + -0.222*x[9] + 0.5461*x[10] + 0.5147*x[11] + 0.0315*x[12] + 0.3514*x[14] + 0.3575*x[15] + -0.0179*x[16] + 0.2363*x[17] + 1.0455*x[18] + 0.3692*x[19] + 0.0029*x[20] + 0.1337*x[21] + -0.0275*x[22] + 0.1445*x[23] + -0.1584*x[24] + 0.1953*x[25] + -0.6703*x[27] + -1.4617*x[28] + -0.2538*x[31] + -1.6377*x[33] + -0.3529*x[34] + -0.7752*x[36] + -0.1691*x[37] + 0.077*x[39] + -0.4735*x[44] + 0.0129*x[45] + -0.0639*x[46] + 0.1084*x[47] + 0.3069*x[48] + 0.2484*x[49] + 0.2791*x[50] + 0.1428*x[51] + 0.3762*x[52] + -0.073*x[53] + 0.0116*x[54] + -0.0108*x[55] + -0.0799*x[56] + -0.297*x[57] + 0.0755*x[58] + 0.1384*x[59] + -0.1115*x[61] + -0.0209*x[62] + -0.1756*x[67] + -0.037*x[68] + -0.1288*x[69] + -0.0135*x[70] + -0.0554*x[71] + -0.0216*x[72] + 0.0721*x[73] + 0.0073*x[74] + 1.2782*x[75] + -3.5037*x[76] + 0.1061*x[77] + 0.0641*x[78] + -0.2165*x[81] + -0.5628*x[82] + 0.5529*x[86] + 1.1678*x[87] + -0.2284*x[88] + -0.5641*x[89] + -0.4474*x[90] + -0.22*x[91] + -0.25*x[92] + -0.0216*x[93] + -0.0063*x[94] + -0.0158*x[95] + 0.0375*x[96] + 0.0006*x[97] + -0.68*x[99] + 0.2057*x[100] + -1.0839*x[101] + -0.5751*x[102] + 0.1676*x[103] + -0.6162*x[106] + -0.7188*x[107] + -0*x[108] + 0*x[109] + 0*x[110] + 0.0014*x[111] + -0.2933*x[113] + -0.4769*x[114] + -0.5147*x[115] + 0.0279*x[116] + 0.5911*x[117] + -0.0062*x[118] + -0.1927*x[120] + -0.1786*x[121] + -1.2849*x[122] + -1.4928*x[123] + 4.7897*x[124] + 0.0336*x[125] + -0.0054*x[126] + 0.0495*x[127] + 0.098*x[128] + -0.4387*x[129] + 0.0348*x[130] + -0.0312*x[131] + 0.1492*x[132] + 0.0977*x[133] + -0.0318*x[134] + 0.378*x[135] + -0.0228*x[136] + 0.0169*x[137] + -0.0228*x[138] + 0.1361*x[139] + -0.0105*x[140] + -0*x[141] + 0.5898*x[142] + 0.245*x[143] + 0.0024*x[144] + 0.0035*x[145] + 0.0009*x[146] + 0.2741*x[147] + 0.0203*x[148] + -0.0129*x[149] + 0.023*x[150] + -0.0079*x[151] + 1.4561*x[152] + -0.0085*x[153] + 0.0087*x[154] + 0.0067*x[155] + -0.0011*x[156] + 0.0175*x[157] + 0.2681*x[158] + 0.579*x[159] + -0.0178*x[160] + 0.2115*x[161] + -0.2301*x[162] + -0.2301*x[163] + 0.7188*x[164] + -0.0781*x[165] + -0.2301*x[167] + 0.6162*x[169] + 0.0852*x[172] + -0.0179*x[173] + 0.0852*x[174] + 0.0722*x[177] + 0.0722*x[178] + 0.0722*x[179] + 0.0722*x[180] + 0.0722*x[181] + 0.0722*x[182] + 0.0722*x[183] + 0.0722*x[184] + 0.0722*x[185] + 0.0722*x[186] + 0.0722*x[187] + 0.0722*x[188] + 0.0722*x[189] + 0.0722*x[190] + 0.0722*x[191] + 0.5356*x[193] + 0.0965*x[197] + 0.1757*x[201] + 0.3217*x[202] + 0.1757*x[203] + 0.3217*x[204] + -0.0685*x[208] + -0.0685*x[209] + -0.0313*x[210] + -0.0313*x[211] + -0.0313*x[212] + -0.0313*x[213] + -0.0313*x[214] + -0.0313*x[215] + -0.0685*x[237] + -0.3598*x[239] + -0.3562*x[240] + -0.1838*x[241] + -0.0179*x[243] + -0.0553*x[244] + -0.0179*x[245] + -0.0553*x[246] + -0.0179*x[247] + -0.0553*x[248] + -0.245*x[249] + -0.0685*x[250] + -0.1268*x[251] + -0.2034*x[252] + -0.1838*x[253] + -0.1838*x[254] + 0.1635*x[255] + 0.1635*x[256] + -0.2831*x[257] + -0.2831*x[258] + -0.0644*x[259] + -0.0644*x[260] + -0.663*x[261] + -0.663*x[262] + -0.0685*x[267] + -0.0685*x[268] + -0.0685*x[269] + -0.0685*x[270] + -0.0685*x[271] + -0.0685*x[272] + -0.0685*x[273] + -0.0685*x[274] + 0.2115*x[275] + -0.2204*x[276] + -0.2204*x[277] + -0.2576*x[279] + -0.579*x[280] + -0.2681*x[281] + -0.1015*x[282] + 0.3042*x[283] + 0.3197*x[284] + -0.3581*x[285] + 0.4482*x[286] + 0.1184*x[288] + -0.0685*x[289] + -0.2048*x[290] + 0.151*x[291] + -0.0685*x[292] + -0.0685*x[293] + -0.0685*x[294] + -0.0685*x[295] + -0.0685*x[296] + 0.0852*x[299] + -0.0179*x[300] + 0.0852*x[301] + -0.0179*x[302] + -0.0179*x[303] + -0.0553*x[305] + -0.0179*x[306] + -0.0179*x[307] + 0.2699*x[309] + -0.0179*x[310] + -0.0179*x[311] + -0.0179*x[312] + 0.1584*x[314] + 0.1344*x[315] + 0.0407*x[316] + 0.2437*x[317] + 0.3373*x[318] + -0.3941*x[319] + -6.47818830720221)))
summary(y)
hist(y$V3)
#cutoff suggested was .01
#New Algorithm
#Submission
y = 1/(1 + exp(-(-1.9974*x[2] + 0.0461*x[6] + -0.4722*x[7] + 0.2963*x[8] + -0.208*x[9] + 0.6178*x[10] + 0.5547*x[11] + 0.0517*x[12] + 0.4287*x[14] + 0.3677*x[15] + 0.2358*x[17] + 1.1441*x[18] + 0.253*x[19] + 0.0048*x[20] + 0.2648*x[21] + -0.0458*x[22] + 0.0025*x[23] + -0.1146*x[24] + 1.5518*x[25] + -0.714*x[27] + -1.4437*x[28] + -0.2044*x[31] + -0.5273*x[34] + -0.7596*x[36] + -0.4596*x[37] + 0.0903*x[39] + 0.0578*x[43] + -0.5582*x[44] + 0.0111*x[45] + -0.058*x[46] + 0.09*x[47] + 0.2737*x[48] + 0.2254*x[49] + 0.2765*x[50] + 0.1391*x[51] + 0.3583*x[52] + -0.0656*x[53] + -0.0112*x[54] + 0.0302*x[55] + -0.1785*x[56] + -0.2796*x[57] + 0.233*x[58] + 0.1641*x[59] + -0.1019*x[61] + -0.0233*x[62] + -0.162*x[67] + -0.0428*x[68] + -0.1285*x[69] + -0.017*x[70] + -0.061*x[71] + -0.0293*x[72] + 0.0645*x[73] + 0.002*x[74] + 1.6167*x[75] + -3.2836*x[76] + 0.1001*x[77] + 0.0644*x[78] + -0.2974*x[81] + -0.4758*x[82] + 0.5199*x[86] + 1.4093*x[87] + -0.1799*x[88] + -0.6834*x[89] + -0.499*x[90] + -0.2314*x[91] + -0.3048*x[92] + -0.0491*x[93] + -0.0022*x[94] + -0.0229*x[95] + 0.042*x[96] + 0.0004*x[97] + 0.0034*x[98] + -0.7826*x[99] + 0.1832*x[100] + -1.096*x[101] + -0.664*x[102] + 0.2245*x[103] + -0.4374*x[106] + -0.893*x[107] + -0*x[108] + 0.0003*x[109] + 0*x[110] + 0.0041*x[111] + 0.0556*x[112] + -0.1786*x[113] + -0.3754*x[114] + -0.4063*x[115] + 0.0904*x[116] + 0.6834*x[117] + -0.0047*x[118] + -0.1244*x[120] + -0.2932*x[121] + -0.9424*x[122] + -1.6408*x[123] + 5.2573*x[124] + 0.0218*x[125] + -0.0051*x[126] + 0.0432*x[127] + 0.0953*x[128] + -0.4401*x[129] + 0.1024*x[130] + -0.026*x[131] + -0.0659*x[134] + 0.5884*x[135] + 0.0056*x[136] + 0.0287*x[137] + -0.0308*x[138] + 0.1486*x[139] + -0.0202*x[140] + -0*x[141] + 0.4798*x[142] + 0.2392*x[143] + 0.0022*x[144] + 0.005*x[145] + 0.0008*x[146] + 0.3107*x[147] + 0.0197*x[148] + -0.0071*x[149] + 0.0257*x[150] + -0.0095*x[151] + 1.8159*x[152] + -0.0081*x[153] + 0.0089*x[154] + 0.0069*x[155] + -0.0007*x[156] + 0.0253*x[157] + 0.269*x[158] + 0.5079*x[159] + -0.111*x[160] + 0.2487*x[161] + -0.2221*x[162] + -0.2221*x[163] + 0.893*x[164] + -0.2221*x[167] + 0.4374*x[169] + 0.2146*x[172] + 0.2146*x[174] + -0.1244*x[175] + 0.0684*x[177] + 0.0684*x[178] + 0.0684*x[179] + 0.0684*x[180] + 0.0684*x[181] + 0.0684*x[182] + 0.0684*x[183] + 0.0684*x[184] + 0.0684*x[185] + 0.0684*x[186] + 0.0684*x[187] + 0.0684*x[188] + 0.0684*x[189] + 0.0684*x[190] + 0.0684*x[191] + 0.5121*x[193] + 0.1313*x[197] + 0.2451*x[201] + 0.4135*x[202] + 0.2451*x[203] + 0.4135*x[204] + -0.0764*x[208] + -0.0764*x[209] + -0.0123*x[210] + -0.0123*x[211] + -0.0123*x[212] + -0.0123*x[213] + -0.0123*x[214] + -0.0123*x[215] + -0.0764*x[237] + -0.4312*x[239] + -0.353*x[240] + -0.21*x[241] + -0.0355*x[244] + -0.0355*x[246] + -0.0355*x[248] + -0.2392*x[249] + -0.0764*x[250] + -0.2219*x[252] + -0.1597*x[253] + -0.1597*x[254] + 0.2032*x[255] + 0.2032*x[256] + -0.2337*x[257] + -0.2337*x[258] + -0.0314*x[259] + -0.0314*x[260] + -0.6442*x[261] + -0.6442*x[262] + -0.0764*x[267] + -0.0764*x[268] + -0.0764*x[269] + -0.0764*x[270] + -0.0764*x[271] + -0.0764*x[272] + -0.0764*x[273] + -0.0764*x[274] + 0.2487*x[275] + -0.3013*x[276] + -0.3013*x[277] + -0.2899*x[279] + -0.5079*x[280] + -0.269*x[281] + -0.4304*x[282] + 0.3207*x[283] + 0.3987*x[284] + -0.3434*x[285] + 0.4909*x[286] + 0.1142*x[288] + -0.0764*x[289] + -0.0886*x[290] + 0.1676*x[291] + -0.0764*x[292] + -0.0764*x[293] + -0.0764*x[294] + -0.0764*x[295] + -0.0764*x[296] + 0.2146*x[299] + 0.2146*x[301] + -0.1244*x[304] + -0.0355*x[305] + 0.1956*x[309] + 0.1146*x[314] + 0.0427*x[315] + 0.0759*x[316] + 0.2735*x[317] + 0.333*x[318] + -0.3844*x[319] + -9.182093881021439)))
#binomial -logistic -  alpha = .3 weight = 10
hist(y)


y
str(y)
pcut<-.14
k<-numeric()
j<-1
for(i in 1:length(y$V3))
{
  if(y$V3[i]>pcut)
  {
    k[j]<-i
    j <- j+1
  }
}

#str(tgmcevaluation)
j<-1
num<-nrow(tgmcevaluation)
finals<- numeric()
for(i in 1:num){
 if(i == k[j])
 {
   finals[j] <- tgmcevaluation$V1[i]
   j<- j + 1
 }
}

length(finals)
str(finals)
#write.table(finals, file = "watsonsubmission1.txt", row.names = FALSE, col.names = FALSE)
#Algorithm = log reg, alpha = .5
#pcut = .8
#length = 103
#Score = 73

#write.table(finals, file = "watsonsubmission2.txt", row.names = FALSE, col.names = FALSE)
#Algorithm = log reg, alpha = .5
#pcut = .7
#length = 159
#Score = 99

#write.table(finals, file = "watsonsubmission3.txt", row.names = FALSE, col.names = FALSE)
#Algorithm = log reg, alpha = .5
#pcut = .65
#length = 197
#Score = 109


#write.table(finals, file = "watsonsubmission4.txt", row.names = FALSE, col.names = FALSE)
#Algorithm = log reg, alpha = .5
#pcut = .63
#length = 210
#Score = 108

#write.table(finals, file = "watsonsubmission7.txt", row.names = FALSE, col.names = FALSE)
#binomial -logistic -  alpha = .3 weight = 10
#pcut = .20
#length = 201
#Score =  101

write.table(finals, file = "watsonsubmission8.txt", row.names = FALSE, col.names = FALSE)
#binomial -logistic -  alpha = .3 weight = 10
#pcut = .15
#length = 259
#Score =  125

write.table(finals, file = "watsonsubmission9.txt", row.names = FALSE, col.names = FALSE)
#binomial -logistic -  alpha = .3 weight = 10
#pcut = .12
#length = 306
#Score =  114

write.table(finals, file = "watsonsubmission10.txt", row.names = FALSE, col.names = FALSE)
#binomial -logistic -  alpha = .3 weight = 10
#pcut = .135
#length = 277
#Score =  127

write.table(finals, file = "watsonsubmission11.txt", row.names = FALSE, col.names = FALSE)
#binomial -logistic -  alpha = .3 weight = 10
#pcut = .130
#length = 289
#Score =  125

write.table(finals, file = "watsonsubmission12.txt", row.names = FALSE, col.names = FALSE)
#binomial -logistic -  alpha = .3 weight = 10
#pcut = .14
#length = 272
#Score = 128